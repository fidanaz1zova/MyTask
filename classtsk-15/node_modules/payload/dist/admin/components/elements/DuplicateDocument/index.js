"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _modal = require("@faceless-ui/modal");
const _react = /*#__PURE__*/ _interop_require_wildcard(require("react"));
const _reacti18next = require("react-i18next");
const _reactrouterdom = require("react-router-dom");
const _reacttoastify = require("react-toastify");
const _getTranslation = require("../../../../utilities/getTranslation");
const _api = require("../../../api");
const _context = require("../../forms/Form/context");
const _Minimal = /*#__PURE__*/ _interop_require_default(require("../../templates/Minimal"));
const _Config = require("../../utilities/Config");
const _Button = /*#__PURE__*/ _interop_require_default(require("../Button"));
const _PopupButtonList = /*#__PURE__*/ _interop_require_wildcard(require("../Popup/PopupButtonList"));
require("./index.scss");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
const baseClass = 'duplicate';
const Duplicate = ({ id, slug, collection })=>{
    const { push } = (0, _reactrouterdom.useHistory)();
    const modified = (0, _context.useFormModified)();
    const { toggleModal } = (0, _modal.useModal)();
    const { setModified } = (0, _context.useForm)();
    const { localization, routes: { api }, serverURL } = (0, _Config.useConfig)();
    const { routes: { admin } } = (0, _Config.useConfig)();
    const [hasClicked, setHasClicked] = (0, _react.useState)(false);
    const [isSubmitting, setIsSubmitting] = (0, _react.useState)(false);
    const { i18n, t } = (0, _reacti18next.useTranslation)('general');
    const modalSlug = `duplicate-${id}`;
    const handleClick = (0, _react.useCallback)(async (override = false)=>{
        if (isSubmitting) return;
        setIsSubmitting(true);
        setHasClicked(true);
        if (modified && !override) {
            toggleModal(modalSlug);
            return;
        }
        const saveDocument = async ({ id, duplicateID = '', locale = '' })=>{
            const response = await _api.requests.get(`${serverURL}${api}/${slug}/${id}`, {
                headers: {
                    'Accept-Language': i18n.language
                },
                params: {
                    depth: 0,
                    draft: true,
                    'fallback-locale': 'none',
                    locale
                }
            });
            let data = await response.json();
            if (typeof collection.admin.hooks?.beforeDuplicate === 'function') {
                data = await collection.admin.hooks.beforeDuplicate({
                    collection,
                    data,
                    locale
                });
            }
            if (!duplicateID) {
                if ('createdAt' in data) delete data.createdAt;
                if ('updatedAt' in data) delete data.updatedAt;
            }
            const result = await _api.requests[duplicateID ? 'patch' : 'post'](`${serverURL}${api}/${slug}/${duplicateID}?locale=${locale}&fallback-locale=none`, {
                body: JSON.stringify(data),
                headers: {
                    'Accept-Language': i18n.language,
                    'Content-Type': 'application/json'
                }
            });
            const json = await result.json();
            if (result.status === 201 || result.status === 200) {
                return json.doc.id;
            }
            // only show the error if this is the initial request failing
            if (!duplicateID) {
                json.errors.forEach((error)=>_reacttoastify.toast.error(error.message));
            }
            return null;
        };
        let duplicateID;
        let abort = false;
        const localeErrors = [];
        if (localization) {
            await localization.localeCodes.reduce(async (priorLocalePatch, locale)=>{
                await priorLocalePatch;
                if (abort) return;
                const localeResult = await saveDocument({
                    id,
                    duplicateID,
                    locale
                });
                duplicateID = localeResult || duplicateID;
                if (duplicateID && !localeResult) {
                    localeErrors.push(locale);
                }
                if (!duplicateID) {
                    abort = true;
                }
            }, Promise.resolve());
        } else {
            duplicateID = await saveDocument({
                id
            });
        }
        if (!duplicateID) {
            // document was not saved, error toast was displayed
            return;
        }
        _reacttoastify.toast.success(t('successfullyDuplicated', {
            label: (0, _getTranslation.getTranslation)(collection.labels.singular, i18n)
        }), {
            autoClose: 3000
        });
        if (localeErrors.length > 0) {
            _reacttoastify.toast.error(`
          ${t('error:localesNotSaved', {
                count: localeErrors.length
            })}
          ${localeErrors.join(', ')}
          `, {
                autoClose: 5000
            });
        }
        setModified(false);
        setIsSubmitting(false);
        setTimeout(()=>{
            push({
                pathname: `${admin}/collections/${slug}/${duplicateID}`
            });
        }, 10);
    }, [
        modified,
        localization,
        t,
        i18n,
        collection,
        setModified,
        toggleModal,
        modalSlug,
        serverURL,
        api,
        slug,
        id,
        push,
        admin
    ]);
    const confirm = (0, _react.useCallback)(async ()=>{
        await handleClick(true);
        setHasClicked(false);
    }, [
        handleClick
    ]);
    return /*#__PURE__*/ _react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/ _react.default.createElement(_PopupButtonList.Button, {
        disabled: isSubmitting,
        id: "action-duplicate",
        onClick: ()=>handleClick(false)
    }, t('duplicate')), modified && hasClicked && /*#__PURE__*/ _react.default.createElement(_modal.Modal, {
        className: `${baseClass}__modal`,
        slug: modalSlug
    }, /*#__PURE__*/ _react.default.createElement(_Minimal.default, {
        className: `${baseClass}__modal-template`
    }, /*#__PURE__*/ _react.default.createElement("h1", null, t('confirmDuplication')), /*#__PURE__*/ _react.default.createElement("p", null, t('unsavedChangesDuplicate')), /*#__PURE__*/ _react.default.createElement(_Button.default, {
        buttonStyle: "secondary",
        id: "confirm-cancel",
        onClick: ()=>toggleModal(modalSlug),
        type: "button"
    }, t('cancel')), /*#__PURE__*/ _react.default.createElement(_Button.default, {
        id: "confirm-duplicate",
        onClick: confirm
    }, t('duplicateWithoutSaving')))));
};
const _default = Duplicate;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9hZG1pbi9jb21wb25lbnRzL2VsZW1lbnRzL0R1cGxpY2F0ZURvY3VtZW50L2luZGV4LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNb2RhbCwgdXNlTW9kYWwgfSBmcm9tICdAZmFjZWxlc3MtdWkvbW9kYWwnXG5pbXBvcnQgUmVhY3QsIHsgdXNlQ2FsbGJhY2ssIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnXG5pbXBvcnQgeyB1c2VUcmFuc2xhdGlvbiB9IGZyb20gJ3JlYWN0LWkxOG5leHQnXG5pbXBvcnQgeyB1c2VIaXN0b3J5IH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSdcbmltcG9ydCB7IHRvYXN0IH0gZnJvbSAncmVhY3QtdG9hc3RpZnknXG5cbmltcG9ydCB0eXBlIHsgUHJvcHMgfSBmcm9tICcuL3R5cGVzJ1xuXG5pbXBvcnQgeyBnZXRUcmFuc2xhdGlvbiB9IGZyb20gJy4uLy4uLy4uLy4uL3V0aWxpdGllcy9nZXRUcmFuc2xhdGlvbidcbmltcG9ydCB7IHJlcXVlc3RzIH0gZnJvbSAnLi4vLi4vLi4vYXBpJ1xuaW1wb3J0IHsgdXNlRm9ybSwgdXNlRm9ybU1vZGlmaWVkIH0gZnJvbSAnLi4vLi4vZm9ybXMvRm9ybS9jb250ZXh0J1xuaW1wb3J0IE1pbmltYWxUZW1wbGF0ZSBmcm9tICcuLi8uLi90ZW1wbGF0ZXMvTWluaW1hbCdcbmltcG9ydCB7IHVzZUNvbmZpZyB9IGZyb20gJy4uLy4uL3V0aWxpdGllcy9Db25maWcnXG5pbXBvcnQgQnV0dG9uIGZyb20gJy4uL0J1dHRvbidcbmltcG9ydCAqIGFzIFBvcHVwTGlzdCBmcm9tICcuLi9Qb3B1cC9Qb3B1cEJ1dHRvbkxpc3QnXG5pbXBvcnQgJy4vaW5kZXguc2NzcydcblxuY29uc3QgYmFzZUNsYXNzID0gJ2R1cGxpY2F0ZSdcblxuY29uc3QgRHVwbGljYXRlOiBSZWFjdC5GQzxQcm9wcz4gPSAoeyBpZCwgc2x1ZywgY29sbGVjdGlvbiB9KSA9PiB7XG4gIGNvbnN0IHsgcHVzaCB9ID0gdXNlSGlzdG9yeSgpXG4gIGNvbnN0IG1vZGlmaWVkID0gdXNlRm9ybU1vZGlmaWVkKClcbiAgY29uc3QgeyB0b2dnbGVNb2RhbCB9ID0gdXNlTW9kYWwoKVxuICBjb25zdCB7IHNldE1vZGlmaWVkIH0gPSB1c2VGb3JtKClcbiAgY29uc3Qge1xuICAgIGxvY2FsaXphdGlvbixcbiAgICByb3V0ZXM6IHsgYXBpIH0sXG4gICAgc2VydmVyVVJMLFxuICB9ID0gdXNlQ29uZmlnKClcbiAgY29uc3Qge1xuICAgIHJvdXRlczogeyBhZG1pbiB9LFxuICB9ID0gdXNlQ29uZmlnKClcbiAgY29uc3QgW2hhc0NsaWNrZWQsIHNldEhhc0NsaWNrZWRdID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpXG4gIGNvbnN0IFtpc1N1Ym1pdHRpbmcsIHNldElzU3VibWl0dGluZ10gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSlcbiAgY29uc3QgeyBpMThuLCB0IH0gPSB1c2VUcmFuc2xhdGlvbignZ2VuZXJhbCcpXG5cbiAgY29uc3QgbW9kYWxTbHVnID0gYGR1cGxpY2F0ZS0ke2lkfWBcblxuICBjb25zdCBoYW5kbGVDbGljayA9IHVzZUNhbGxiYWNrKFxuICAgIGFzeW5jIChvdmVycmlkZSA9IGZhbHNlKSA9PiB7XG4gICAgICBpZiAoaXNTdWJtaXR0aW5nKSByZXR1cm5cbiAgICAgIHNldElzU3VibWl0dGluZyh0cnVlKVxuICAgICAgc2V0SGFzQ2xpY2tlZCh0cnVlKVxuXG4gICAgICBpZiAobW9kaWZpZWQgJiYgIW92ZXJyaWRlKSB7XG4gICAgICAgIHRvZ2dsZU1vZGFsKG1vZGFsU2x1ZylcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHNhdmVEb2N1bWVudCA9IGFzeW5jICh7XG4gICAgICAgIGlkLFxuICAgICAgICBkdXBsaWNhdGVJRCA9ICcnLFxuICAgICAgICBsb2NhbGUgPSAnJyxcbiAgICAgIH0pOiBQcm9taXNlPG51bGwgfCBzdHJpbmc+ID0+IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0cy5nZXQoYCR7c2VydmVyVVJMfSR7YXBpfS8ke3NsdWd9LyR7aWR9YCwge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBY2NlcHQtTGFuZ3VhZ2UnOiBpMThuLmxhbmd1YWdlLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICBkZXB0aDogMCxcbiAgICAgICAgICAgIGRyYWZ0OiB0cnVlLFxuICAgICAgICAgICAgJ2ZhbGxiYWNrLWxvY2FsZSc6ICdub25lJyxcbiAgICAgICAgICAgIGxvY2FsZSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgICAgICBsZXQgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuXG4gICAgICAgIGlmICh0eXBlb2YgY29sbGVjdGlvbi5hZG1pbi5ob29rcz8uYmVmb3JlRHVwbGljYXRlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgZGF0YSA9IGF3YWl0IGNvbGxlY3Rpb24uYWRtaW4uaG9va3MuYmVmb3JlRHVwbGljYXRlKHtcbiAgICAgICAgICAgIGNvbGxlY3Rpb24sXG4gICAgICAgICAgICBkYXRhLFxuICAgICAgICAgICAgbG9jYWxlLFxuICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWR1cGxpY2F0ZUlEKSB7XG4gICAgICAgICAgaWYgKCdjcmVhdGVkQXQnIGluIGRhdGEpIGRlbGV0ZSBkYXRhLmNyZWF0ZWRBdFxuICAgICAgICAgIGlmICgndXBkYXRlZEF0JyBpbiBkYXRhKSBkZWxldGUgZGF0YS51cGRhdGVkQXRcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcXVlc3RzW2R1cGxpY2F0ZUlEID8gJ3BhdGNoJyA6ICdwb3N0J10oXG4gICAgICAgICAgYCR7c2VydmVyVVJMfSR7YXBpfS8ke3NsdWd9LyR7ZHVwbGljYXRlSUR9P2xvY2FsZT0ke2xvY2FsZX0mZmFsbGJhY2stbG9jYWxlPW5vbmVgLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAnQWNjZXB0LUxhbmd1YWdlJzogaTE4bi5sYW5ndWFnZSxcbiAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgKVxuICAgICAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzdWx0Lmpzb24oKVxuXG4gICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEgfHwgcmVzdWx0LnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgcmV0dXJuIGpzb24uZG9jLmlkXG4gICAgICAgIH1cblxuICAgICAgICAvLyBvbmx5IHNob3cgdGhlIGVycm9yIGlmIHRoaXMgaXMgdGhlIGluaXRpYWwgcmVxdWVzdCBmYWlsaW5nXG4gICAgICAgIGlmICghZHVwbGljYXRlSUQpIHtcbiAgICAgICAgICBqc29uLmVycm9ycy5mb3JFYWNoKChlcnJvcikgPT4gdG9hc3QuZXJyb3IoZXJyb3IubWVzc2FnZSkpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cblxuICAgICAgbGV0IGR1cGxpY2F0ZUlEOiBzdHJpbmdcbiAgICAgIGxldCBhYm9ydCA9IGZhbHNlXG4gICAgICBjb25zdCBsb2NhbGVFcnJvcnMgPSBbXVxuXG4gICAgICBpZiAobG9jYWxpemF0aW9uKSB7XG4gICAgICAgIGF3YWl0IGxvY2FsaXphdGlvbi5sb2NhbGVDb2Rlcy5yZWR1Y2UoYXN5bmMgKHByaW9yTG9jYWxlUGF0Y2gsIGxvY2FsZSkgPT4ge1xuICAgICAgICAgIGF3YWl0IHByaW9yTG9jYWxlUGF0Y2hcbiAgICAgICAgICBpZiAoYWJvcnQpIHJldHVyblxuICAgICAgICAgIGNvbnN0IGxvY2FsZVJlc3VsdCA9IGF3YWl0IHNhdmVEb2N1bWVudCh7XG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIGR1cGxpY2F0ZUlELFxuICAgICAgICAgICAgbG9jYWxlLFxuICAgICAgICAgIH0pXG4gICAgICAgICAgZHVwbGljYXRlSUQgPSBsb2NhbGVSZXN1bHQgfHwgZHVwbGljYXRlSURcbiAgICAgICAgICBpZiAoZHVwbGljYXRlSUQgJiYgIWxvY2FsZVJlc3VsdCkge1xuICAgICAgICAgICAgbG9jYWxlRXJyb3JzLnB1c2gobG9jYWxlKVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWR1cGxpY2F0ZUlEKSB7XG4gICAgICAgICAgICBhYm9ydCA9IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH0sIFByb21pc2UucmVzb2x2ZSgpKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZHVwbGljYXRlSUQgPSBhd2FpdCBzYXZlRG9jdW1lbnQoeyBpZCB9KVxuICAgICAgfVxuXG4gICAgICBpZiAoIWR1cGxpY2F0ZUlEKSB7XG4gICAgICAgIC8vIGRvY3VtZW50IHdhcyBub3Qgc2F2ZWQsIGVycm9yIHRvYXN0IHdhcyBkaXNwbGF5ZWRcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIHRvYXN0LnN1Y2Nlc3MoXG4gICAgICAgIHQoJ3N1Y2Nlc3NmdWxseUR1cGxpY2F0ZWQnLCB7IGxhYmVsOiBnZXRUcmFuc2xhdGlvbihjb2xsZWN0aW9uLmxhYmVscy5zaW5ndWxhciwgaTE4bikgfSksXG4gICAgICAgIHsgYXV0b0Nsb3NlOiAzMDAwIH0sXG4gICAgICApXG5cbiAgICAgIGlmIChsb2NhbGVFcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgICB0b2FzdC5lcnJvcihcbiAgICAgICAgICBgXG4gICAgICAgICAgJHt0KCdlcnJvcjpsb2NhbGVzTm90U2F2ZWQnLCB7IGNvdW50OiBsb2NhbGVFcnJvcnMubGVuZ3RoIH0pfVxuICAgICAgICAgICR7bG9jYWxlRXJyb3JzLmpvaW4oJywgJyl9XG4gICAgICAgICAgYCxcbiAgICAgICAgICB7IGF1dG9DbG9zZTogNTAwMCB9LFxuICAgICAgICApXG4gICAgICB9XG5cbiAgICAgIHNldE1vZGlmaWVkKGZhbHNlKVxuICAgICAgc2V0SXNTdWJtaXR0aW5nKGZhbHNlKVxuXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgcHVzaCh7XG4gICAgICAgICAgcGF0aG5hbWU6IGAke2FkbWlufS9jb2xsZWN0aW9ucy8ke3NsdWd9LyR7ZHVwbGljYXRlSUR9YCxcbiAgICAgICAgfSlcbiAgICAgIH0sIDEwKVxuICAgIH0sXG4gICAgW1xuICAgICAgbW9kaWZpZWQsXG4gICAgICBsb2NhbGl6YXRpb24sXG4gICAgICB0LFxuICAgICAgaTE4bixcbiAgICAgIGNvbGxlY3Rpb24sXG4gICAgICBzZXRNb2RpZmllZCxcbiAgICAgIHRvZ2dsZU1vZGFsLFxuICAgICAgbW9kYWxTbHVnLFxuICAgICAgc2VydmVyVVJMLFxuICAgICAgYXBpLFxuICAgICAgc2x1ZyxcbiAgICAgIGlkLFxuICAgICAgcHVzaCxcbiAgICAgIGFkbWluLFxuICAgIF0sXG4gIClcblxuICBjb25zdCBjb25maXJtID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGhhbmRsZUNsaWNrKHRydWUpXG4gICAgc2V0SGFzQ2xpY2tlZChmYWxzZSlcbiAgfSwgW2hhbmRsZUNsaWNrXSlcblxuICByZXR1cm4gKFxuICAgIDxSZWFjdC5GcmFnbWVudD5cbiAgICAgIDxQb3B1cExpc3QuQnV0dG9uXG4gICAgICAgIGRpc2FibGVkPXtpc1N1Ym1pdHRpbmd9XG4gICAgICAgIGlkPVwiYWN0aW9uLWR1cGxpY2F0ZVwiXG4gICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZUNsaWNrKGZhbHNlKX1cbiAgICAgID5cbiAgICAgICAge3QoJ2R1cGxpY2F0ZScpfVxuICAgICAgPC9Qb3B1cExpc3QuQnV0dG9uPlxuICAgICAge21vZGlmaWVkICYmIGhhc0NsaWNrZWQgJiYgKFxuICAgICAgICA8TW9kYWwgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X19tb2RhbGB9IHNsdWc9e21vZGFsU2x1Z30+XG4gICAgICAgICAgPE1pbmltYWxUZW1wbGF0ZSBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX21vZGFsLXRlbXBsYXRlYH0+XG4gICAgICAgICAgICA8aDE+e3QoJ2NvbmZpcm1EdXBsaWNhdGlvbicpfTwvaDE+XG4gICAgICAgICAgICA8cD57dCgndW5zYXZlZENoYW5nZXNEdXBsaWNhdGUnKX08L3A+XG4gICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgIGJ1dHRvblN0eWxlPVwic2Vjb25kYXJ5XCJcbiAgICAgICAgICAgICAgaWQ9XCJjb25maXJtLWNhbmNlbFwiXG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHRvZ2dsZU1vZGFsKG1vZGFsU2x1Zyl9XG4gICAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7dCgnY2FuY2VsJyl9XG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgIDxCdXR0b24gaWQ9XCJjb25maXJtLWR1cGxpY2F0ZVwiIG9uQ2xpY2s9e2NvbmZpcm19PlxuICAgICAgICAgICAgICB7dCgnZHVwbGljYXRlV2l0aG91dFNhdmluZycpfVxuICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgPC9NaW5pbWFsVGVtcGxhdGU+XG4gICAgICAgIDwvTW9kYWw+XG4gICAgICApfVxuICAgIDwvUmVhY3QuRnJhZ21lbnQ+XG4gIClcbn1cblxuZXhwb3J0IGRlZmF1bHQgRHVwbGljYXRlXG4iXSwibmFtZXMiOlsiYmFzZUNsYXNzIiwiRHVwbGljYXRlIiwiaWQiLCJzbHVnIiwiY29sbGVjdGlvbiIsInB1c2giLCJ1c2VIaXN0b3J5IiwibW9kaWZpZWQiLCJ1c2VGb3JtTW9kaWZpZWQiLCJ0b2dnbGVNb2RhbCIsInVzZU1vZGFsIiwic2V0TW9kaWZpZWQiLCJ1c2VGb3JtIiwibG9jYWxpemF0aW9uIiwicm91dGVzIiwiYXBpIiwic2VydmVyVVJMIiwidXNlQ29uZmlnIiwiYWRtaW4iLCJoYXNDbGlja2VkIiwic2V0SGFzQ2xpY2tlZCIsInVzZVN0YXRlIiwiaXNTdWJtaXR0aW5nIiwic2V0SXNTdWJtaXR0aW5nIiwiaTE4biIsInQiLCJ1c2VUcmFuc2xhdGlvbiIsIm1vZGFsU2x1ZyIsImhhbmRsZUNsaWNrIiwidXNlQ2FsbGJhY2siLCJvdmVycmlkZSIsInNhdmVEb2N1bWVudCIsImR1cGxpY2F0ZUlEIiwibG9jYWxlIiwicmVzcG9uc2UiLCJyZXF1ZXN0cyIsImdldCIsImhlYWRlcnMiLCJsYW5ndWFnZSIsInBhcmFtcyIsImRlcHRoIiwiZHJhZnQiLCJkYXRhIiwianNvbiIsImhvb2tzIiwiYmVmb3JlRHVwbGljYXRlIiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0IiwicmVzdWx0IiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdGF0dXMiLCJkb2MiLCJlcnJvcnMiLCJmb3JFYWNoIiwiZXJyb3IiLCJ0b2FzdCIsIm1lc3NhZ2UiLCJhYm9ydCIsImxvY2FsZUVycm9ycyIsImxvY2FsZUNvZGVzIiwicmVkdWNlIiwicHJpb3JMb2NhbGVQYXRjaCIsImxvY2FsZVJlc3VsdCIsIlByb21pc2UiLCJyZXNvbHZlIiwic3VjY2VzcyIsImxhYmVsIiwiZ2V0VHJhbnNsYXRpb24iLCJsYWJlbHMiLCJzaW5ndWxhciIsImF1dG9DbG9zZSIsImxlbmd0aCIsImNvdW50Iiwiam9pbiIsInNldFRpbWVvdXQiLCJwYXRobmFtZSIsImNvbmZpcm0iLCJSZWFjdCIsIkZyYWdtZW50IiwiUG9wdXBMaXN0IiwiQnV0dG9uIiwiZGlzYWJsZWQiLCJvbkNsaWNrIiwiTW9kYWwiLCJjbGFzc05hbWUiLCJNaW5pbWFsVGVtcGxhdGUiLCJoMSIsInAiLCJidXR0b25TdHlsZSIsInR5cGUiXSwibWFwcGluZ3MiOiI7Ozs7K0JBb05BOzs7ZUFBQTs7O3VCQXBOZ0M7K0RBQ2E7OEJBQ2Q7Z0NB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